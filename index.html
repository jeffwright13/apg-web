<!doctype html>
<html lang="en" data-theme="auto">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Audio Program Generator</title>
    <meta
      name="description"
      content="Generate spoken audio programs from text with optional background music"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />
    <link rel="stylesheet" href="styles/custom.css" />
  </head>
  <body>
    <main class="container">
      <header>
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
          <div style="flex: 1;">
            <h1 style="margin-bottom: 0.5rem;">Audio Program Generator</h1>
            <p style="margin-bottom: 0;">
              Create spoken audio programs from text with optional background music
            </p>
          </div>
          
          <!-- Theme Switcher -->
          <div id="theme-switcher" style="display: flex; gap: 0.5rem; align-items: center; padding-top: 0.25rem;">
            <small style="opacity: 0.7; white-space: nowrap;">Theme:</small>
            <select id="theme-select" style="width: auto; padding: 0.25rem 0.5rem; font-size: 0.875rem; margin: 0;" aria-label="Theme selector">
              <option value="auto">Auto</option>
              <option value="light">Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>
        </div>
      </header>

      <section id="input-section">
        <article>
          <header><h2>Input</h2></header>

          <form id="apg-form">
            <!-- Phrase File -->
            <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem;">
              <label for="phrase-file" style="margin-bottom: 0;">
                Phrase File
              </label>
              <small>Text file with phrases and pauses (required)</small>
            </div>
            <div style="display: flex; gap: 0.5rem; align-items: stretch">
              <input
                type="file"
                id="phrase-file"
                name="phrase-file"
                accept=".txt"
                style="flex: 1"
              />
              <button
                type="button"
                id="clear-phrase-btn"
                class="secondary"
                style="flex: 0 0 auto; height: auto;"
                title="Clear phrase file"
              >
                Clear
              </button>
            </div>

            <!-- Background Sound -->
            <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem;">
              <label for="sound-file" style="margin-bottom: 0;">
                Background Sound
              </label>
              <small id="sound-file-help">Optional audio file (MP3, WAV, OGG, M4A, etc.)</small>
            </div>
            <div style="display: flex; gap: 0.5rem; align-items: stretch">
              <input
                type="file"
                id="sound-file"
                name="sound-file"
                accept=".wav,.mp3,.ogg,.m4a,.aac,.flac,.aiff,.aif,.webm,audio/*"
                style="flex: 1"
              />
              <button
                type="button"
                id="clear-sound-btn"
                class="secondary"
                style="flex: 0 0 auto; height: auto;"
                title="Clear background sound file"
              >
                Clear
              </button>
            </div>

            <!-- TTS Engine -->
            <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem;">
              <label for="tts-engine" style="margin-bottom: 0;">
                Text-to-Speech Engine
              </label>
              <small>Which voice generation service to use</small>
            </div>
            <select id="tts-engine" name="tts-engine">
                <option value="openai">
                  OpenAI TTS (pay-as-you-go - $15/1M chars)
                </option>
                <option value="google-cloud">
                  Google Cloud TTS (free tier - recommended)
                </option>
                <option value="web-speech">
                  Web Speech API (free - playback only, browser-dependent)
                </option>
                <option value="gtts" disabled>
                  Google Translate TTS (legacy feaure - coming soon)
                </option>
                <option value="elevenlabs" disabled>
                  ElevenLabs (premium feature - coming soon)
                </option>
              </select>

            <!-- Browser Warning (Web Speech API) -->
            <div id="browser-warning" style="display: none; margin-top: 1rem; margin-bottom: 1.5rem; padding: 0.75rem; background: var(--card-background-color); border-left: 3px solid var(--del-color); border-radius: 0.25rem;">
              <small style="color: var(--muted-color); line-height: 1.6;">
                ⚠️ <strong style="color: var(--del-color);">Browser Compatibility:</strong> Web Speech API audio quality varies significantly by browser. <strong>Chrome</strong> and <strong>Edge</strong> provide the best results. Firefox and Safari may produce poor quality audio.
                <br /><br />
                <strong>Note:</strong> Web Speech API plays directly through your speakers and doesn't support audio export or background mixing.
                <br /><br />
                For consistent, high-quality audio across all browsers with export and mixing support, use Google Cloud TTS.
              </small>
            </div>

            <!-- gTTS Settings -->
            <div id="gtts-settings" style="display: none">
              <label for="gtts-accent">
                Accent/Region
                <select id="gtts-accent" name="gtts-accent">
                  <option value="com">United States</option>
                  <option value="co.uk">United Kingdom</option>
                  <option value="com.au">Australia</option>
                  <option value="ca">Canada</option>
                  <option value="co.in">India</option>
                  <option value="ie">Ireland</option>
                  <option value="co.za">South Africa</option>
                </select>
              </label>
            </div>

            <!-- Google Cloud TTS Settings -->
            <div id="google-cloud-settings" style="display: none">
              <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem;">
                <label for="google-api-key" style="margin-bottom: 0;">
                  Google Cloud API Key
                </label>
                <small>
                  <a
                    href="https://console.cloud.google.com/apis/credentials"
                    target="_blank"
                    >Get API Key</a
                  >
                </small>
              </div>
              <div style="display: flex; gap: 0.5rem">
                <input
                  type="password"
                  id="google-api-key"
                  name="google-api-key"
                  placeholder="Enter your Google Cloud API key (stored locally in browser)"
                  style="flex: 1"
                />
                <button
                  type="button"
                  id="save-api-key-btn"
                  class="secondary"
                  style="flex: 0 0 auto"
                >
                  Save
                </button>
              </div>

              <label for="google-voice">
                Voice
                <select id="google-voice" name="google-voice">
                  <option value="en-US-Neural2-C">
                    en-US-Neural2-C (Female)
                  </option>
                  <option value="en-US-Neural2-A">en-US-Neural2-A (Male)</option>
                  <option value="en-US-Neural2-D">en-US-Neural2-D (Male)</option>
                  <option value="en-US-Neural2-E">
                    en-US-Neural2-E (Female)
                  </option>
                </select>
              </label>

              <details>
                <summary>Advanced Voice Settings</summary>

                <label for="speaking-rate">
                  Speaking Rate: <span id="speaking-rate-value">1.0</span>
                  <input
                    type="range"
                    id="speaking-rate"
                    name="speaking-rate"
                    min="0.25"
                    max="4.0"
                    step="0.25"
                    value="1.0"
                  />
                </label>

                <label for="pitch">
                  Pitch: <span id="pitch-value">0.0</span>
                  <input
                    type="range"
                    id="pitch"
                    name="pitch"
                    min="-20"
                    max="20"
                    step="1"
                    value="0"
                  />
                </label>

                <label for="volume-gain">
                  Volume Gain (dB): <span id="volume-gain-value">0.0</span>
                  <input
                    type="range"
                    id="volume-gain"
                    name="volume-gain"
                    min="-96"
                    max="16"
                    step="1"
                    value="0"
                  />
                </label>
              </details>
            </div>

            <!-- OpenAI TTS Settings -->
            <div id="openai-settings" style="display: none">
              <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem;">
                <label for="openai-api-key" style="margin-bottom: 0;">
                  OpenAI API Key
                </label>
                <small>
                  <a
                    href="https://platform.openai.com/api-keys"
                    target="_blank"
                    >Get API Key</a
                  >
                </small>
              </div>
              <div style="display: flex; gap: 0.5rem">
                <input
                  type="password"
                  id="openai-api-key"
                  name="openai-api-key"
                  placeholder="Enter your OpenAI API key (stored locally in browser)"
                  style="flex: 1"
                />
                <button
                  type="button"
                  id="save-openai-key-btn"
                  class="secondary"
                  style="flex: 0 0 auto"
                >
                  Save
                </button>
              </div>

              <label for="openai-voice">
                Voice
                <select id="openai-voice" name="openai-voice">
                  <option value="nova">Nova (Female - warm and friendly)</option>
                  <option value="shimmer">Shimmer (Female - soft and gentle)</option>
                  <option value="alloy">Alloy (Neutral - balanced)</option>
                  <option value="echo">Echo (Male)</option>
                  <option value="fable">Fable (Male - British)</option>
                  <option value="onyx">Onyx (Male - deep)</option>
                </select>
              </label>

              <label for="openai-model">
                Model Quality
                <select id="openai-model" name="openai-model">
                  <option value="tts-1">Standard ($15/1M chars)</option>
                  <option value="tts-1-hd">HD Quality ($30/1M chars)</option>
                </select>
              </label>

              <label for="openai-speed">
                Speed: <span id="openai-speed-value">1.0</span>
                <input
                  type="range"
                  id="openai-speed"
                  name="openai-speed"
                  min="0.25"
                  max="4.0"
                  step="0.25"
                  value="1.0"
                />
              </label>
            </div>

            <hr style="margin: 2rem 0; border: none; border-top: 1px solid var(--muted-border-color);" />

            <!-- Options -->
            <details>
              <summary>Advanced Options</summary>

              <label>
                <input type="checkbox" id="slow-speech" name="slow-speech" />
                Slow speech (half speed)
              </label>

              <label for="attenuation">
                Background volume adjustment (dB)
                <input
                  type="number"
                  id="attenuation"
                  name="attenuation"
                  value="-6"
                  min="-40"
                  max="6"
                  step="1"
                />
                <small style="color: var(--muted-color);">
                  Negative = quieter, Positive = louder. Try -12 (quarter volume), -6 (half), 0 (same as speech), +3 (1.4x louder)
                </small>
              </label>

              <label for="fade-in">
                Fade in (ms)
                <input
                  type="number"
                  id="fade-in"
                  name="fade-in"
                  value="3000"
                  min="0"
                  max="10000"
                  step="100"
                />
              </label>

              <label for="fade-out">
                Fade out (ms)
                <input
                  type="number"
                  id="fade-out"
                  name="fade-out"
                  value="6000"
                  min="0"
                  max="10000"
                  step="100"
                />
              </label>
            </details>

          </form>
        </article>
      </section>

      <section id="output-section">
        <article>
          <header><h2>Output</h2></header>
          <button type="submit" form="apg-form" id="generate-btn">
            Generate Audio
          </button>

          <!-- Progress -->
          <div id="progress-container" style="display: none">
            <progress id="progress-bar" value="0" max="100"></progress>
            <p id="progress-text" style="text-align: center; margin-top: 0.5rem">
              Initializing...
            </p>
          </div>

          <!-- Playback Controls (Web Speech API) -->
          <div id="playback-controls" style="display: none">
            <div
              style="
                display: flex;
                gap: 1rem;
                justify-content: center;
                margin-top: 1rem;
              "
            >
              <button id="play-btn">▶ Play Audio</button>
              <button id="stop-btn" class="secondary">⏹ Stop</button>
            </div>
          </div>

          <!-- Download Controls (Premium TTS) -->
          <div id="download-controls" style="display: none">
            <audio id="audio-player" controls style="margin-top: 1rem"></audio>
            <button id="download-btn">Download Audio</button>
          </div>
        </article>
      </section>

      <footer>
        <small
          >Audio Program Generator v1.0.0 | Created by Jeff Wright |
          <a href="https://github.com/jeffwright13/apg-web">GitHub</a></small
        >
      </footer>
    </main>

    <script type="module" src="scripts/main.js"></script>
  </body>
</html>
